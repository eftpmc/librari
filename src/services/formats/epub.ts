const Epub = require("epub-gen");

interface Chapter {
    title: string;
    data: string;
}

export async function epub(title: string, coverImage: ArrayBuffer, chapters: string[]): Promise<void> {
    const option = {
        title: title,
        author: "Ari",
        cover: coverImage,
        content: [
            {
                title: 'Introduction',
                data: `
                    <h1>Introduction</h1>
                    <p>This book was programmatically generated by Ari...</p>
                `
            },
            ...chapters.map((chapterText, index): Chapter => ({
                title: `Chapter ${index + 1}`,
                data: `<h1>Chapter ${index + 1}</h1>${chapterText}`
            }))
        ],
        appendChapterTitles: false,
    };

    new Epub(option, `./${title}.epub`);
}

